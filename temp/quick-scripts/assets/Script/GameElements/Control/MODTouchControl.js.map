{"version":3,"sources":["MODTouchControl.js"],"names":["o0","require","o0CC","cc","Class","extends","Component","properties","player","UINode","keyDirection","key","leftButton","rightButton","jumpButton","update","screen","view","getVisibleSize","node","x","width","y","height","start","getComponent","log","self","addNode","name","on","Node","EventType","TOUCH_START","event","updateMotionState","TOUCH_END","TOUCH_CANCEL","jump","onDestroy","targetVector","_key","setMotionState"],"mappings":"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","file":"MODTouchControl.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\GameElements\\Control","sourcesContent":["var o0 = require('o0');\nvar o0CC = require('o0CC');\n\n\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        player:null,\n        UINode:null,\n\n        keyDirection:null,\n        key:null,\n\n        leftButton:null,\n        rightButton:null,\n\n        jumpButton:null,\n    },\n    update(){\n        var screen = cc.view.getVisibleSize();\n        \n        //this.leftButton.node.x = 30+this.leftButton.node.width-screen.width/2;\n        //this.leftButton.node.y = 30+this.leftButton.node.height-screen.height/2;\n        this.leftButton.node.x = 40+(this.leftButton.node.width-screen.width)/2;\n        this.leftButton.node.y = 40+(this.leftButton.node.height-screen.height)/2;\n        \n        this.rightButton.node.x = this.rightButton.node.width + this.leftButton.node.x;\n        this.rightButton.node.y = this.leftButton.node.y;/** */\n        \n        this.jumpButton.node.x = -40-(this.leftButton.node.width-screen.width)/2;\n        this.jumpButton.node.y = 40+(this.leftButton.node.height-screen.height)/2;\n    },\n    start: function () {        \n        if(this.player == null){\n            this.player = this.node.getComponent('MODCharacter');\n            if(this.player == null){\n                o0CC.log('player null')\n            }\n        }\n        var self = this;\n\n        this.keyDirection = {};\n        this.key = {};\n\n        this.leftButton = o0CC.addNode(this.UINode,10,'o0CCButton').getComponent('o0CCButton');\n        this.leftButton.node.width = 100;\n        this.leftButton.node.height = 100;/** */\n        this.leftButton.name = '←';\n        this.leftButton.node.on(cc.Node.EventType.TOUCH_START, function (event) {\n            self.key[this.leftButton.name] = true;\n            self.updateMotionState();\n        }, this);\n        this.leftButton.node.on(cc.Node.EventType.TOUCH_END, function (event) {\n            self.key[this.leftButton.name] = false;\n            self.updateMotionState();\n        }, this);\n        this.leftButton.node.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {\n            self.key[this.leftButton.name] = false;\n            self.updateMotionState();\n        }, this);\n        this.keyDirection[this.leftButton.name] = -1;\n\n        this.rightButton = o0CC.addNode(this.UINode,10,'o0CCButton').getComponent('o0CCButton');\n        this.rightButton.node.width = 100;\n        this.rightButton.node.height = 100;/** */\n        this.rightButton.name = '→';\n        this.rightButton.node.on(cc.Node.EventType.TOUCH_START, function (event) {\n            self.key[this.rightButton.name] = true;\n            self.updateMotionState();\n        }, this);\n        this.rightButton.node.on(cc.Node.EventType.TOUCH_END, function (event) {\n            self.key[this.rightButton.name] = false;\n            self.updateMotionState();\n        }, this);\n        this.rightButton.node.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {\n            self.key[this.rightButton.name] = false;\n            self.updateMotionState();\n        }, this);\n        this.keyDirection[this.rightButton.name] = 1;\n\n        this.jumpButton = o0CC.addNode(this.UINode,10,'o0CCButton').getComponent('o0CCButton');\n        this.jumpButton.node.width = 100;\n        this.jumpButton.node.height = 100;/** */\n        this.jumpButton.name = '↑';\n        this.jumpButton.node.on(cc.Node.EventType.TOUCH_START, function (event) {\n            self.player.jump();\n        }, this);\n    },\n    onDestroy () {\n    },\n\n    updateMotionState: function () {\n        var targetVector = 0;\n        for(var _key in this.keyDirection){\n            if(this.key[_key] == true){\n                targetVector += this.keyDirection[_key];\n            }\n        }\n        this.player.setMotionState(targetVector);\n    },\n});"]}