{"version":3,"sources":["MODChainsaw.js"],"names":["o0","require","o0CC","o0Game","cc","Class","extends","Component","properties","joint","rigidBody","collider","invinciblePlayer","nameLabel","host","players","map","toData","sensor","node","rotation","position","linearVelocity","connectedBody","tag","Tag","Player","name","referenceAngle","connectedAnchor","syncData","data","disconnect","rot","x","pos","y","vel","conTag","conId","Ground","connectGround","apply","connectPlayer","blend","onLoad","Chainsaw","scaleX","scaleY","addNode","Label","getComponent","horizontalAlign","HorizontalAlign","CENTER","verticalAlign","VerticalAlign","TOP","color","Color","anchorX","anchorY","height","fontSize","addSprite","addComponent","RigidBody","enabledContactListener","gravityScale","fixedRotation","PhysicsBoxCollider","size","Size","density","update","dt","newLabelString","i","string","updateJoint","direction","v2","MODCharacter","player","hand","destroy","push","WeldJoint","enabled","MODMap","bounceOff","otherChainsaw","otherPlayer","contact","worldManifold","getWorldManifold","point","points","undefined","log","scheduleOnce","force","normalizeSelf","mulSelf","angularVelocity","Math","random","onBeginContact","selfCollider","otherCollider","self","active","body","chainsawA","playerA","chainsawB","playerB"],"mappings":"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","file":"MODChainsaw.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\GameElements","sourcesContent":["\nvar o0 = require('o0');\nvar o0CC = require('o0CC');\nvar o0Game = require('o0Game');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        joint:null,\n        rigidBody:null,\n        collider:null,\n        invinciblePlayer:[],//无敌状态\n        \n        nameLabel:null,\n        host:false,\n        players:null,\n        map:null,\n    },\n\n    \n    toData(){\n        if(this.joint == null){//空中\n            return {'joint':false,\n                'sensor':this.collider.sensor,\n                'rot':this.node.rotation,\n                'pos':this.node.position,\n                'vel':this.rigidBody.linearVelocity};\n        }else if(this.joint.connectedBody.node.tag == o0Game.Tag.Player){/*//玩家手上\n            return {'joint':true,\n                'sensor':this.collider.sensor,\n                'rot':this.joint.referenceAngle,\n                'pos':this.joint.connectedAnchor,\n                'conTag':this.joint.connectedBody.node.tag,\n                'conId':this.joint.connectedBody.node.name};/** */\n            return {'joint':true,\n            'sensor':this.collider.sensor,\n            'conTag':this.joint.connectedBody.node.tag,\n            'conId':this.joint.connectedBody.node.name};/** */\n        }else{// if(this.joint.connectedBody.node.tag == o0Game.Tag.Ground){//插地上\n            return {'joint':true,\n                'sensor':this.collider.sensor,\n                'rot':this.joint.referenceAngle,\n                'pos':this.joint.connectedAnchor,\n                'conTag':this.joint.connectedBody.node.tag};\n        }\n    },\n    syncData(data){\n        if(data.joint == false && this.joint != null){\n            this.disconnect();\n            this.node.rotation = data.rot;\n            this.node.x = data.pos.x;\n            this.node.y = data.pos.y;\n            this.rigidBody.linearVelocity.x = data.vel.x;\n            this.rigidBody.linearVelocity.y = data.vel.y;\n        }else if(data.joint == true && (this.joint == null || this.joint.connectedBody.node.tag != data.conTag || (this.joint.connectedBody.node.tag == o0Game.Tag.Player && this.joint.connectedBody.node.name != data.conId))){\n            if(data.conTag == o0Game.Tag.Ground){\n                this.connectGround(this.map);\n                this.joint.referenceAngle = data.rot;\n                this.joint.connectedAnchor.x = data.pos.x;\n                this.joint.connectedAnchor.y = data.pos.y;\n                this.joint.apply();\n            }else if(data.conTag == o0Game.Tag.Player){\n                this.connectPlayer(this.players[data.conId]);\n                //this.updateJoint(this.players[data.conId].node.scaleX);\n            }\n        }else if(this.joint == null && data.joint == false){\n            this.node.rotation = o0.blend(this.node.rotation,data.rot,0.1);\n            this.node.x = o0.blend(this.node.x,data.pos.x,0.1);\n            this.node.y = o0.blend(this.node.y,data.pos.y,0.1);\n            this.rigidBody.linearVelocity.x = o0.blend(this.rigidBody.linearVelocity.x,data.vel.x,0.3);\n            this.rigidBody.linearVelocity.y = o0.blend(this.rigidBody.linearVelocity.y,data.vel.y,0.3);\n        }/*else if(this.joint != null && data.joint == true){\n            if((this.joint.connectedBody.node.tag == o0Game.Tag.Ground && data.conTag == o0Game.Tag.Ground)\n                ||(this.joint.connectedBody.node.tag == o0Game.Tag.Player && data.conTag == o0Game.Tag.Player && this.joint.connectedBody.node.name == data.conId)){\n                this.joint.referenceAngle = o0.blend(this.joint.referenceAngle,data.rot,0.1);\n                this.joint.connectedAnchor.x = o0.blend(this.joint.connectedAnchor.x,data.pos.x,0.1);\n                this.joint.connectedAnchor.y = o0.blend(this.joint.connectedAnchor.y,data.pos.y,0.1);\n                this.joint.apply();\n                //cc.log('sdadsadasdasssssssssssssssss');\n            }\n        }/** */\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        this.node.tag = o0Game.Tag.Chainsaw;\n        this.node.scaleX = 0.3;\n        this.node.scaleY = 0.3;\n        \n        this.nameLabel = o0CC.addNode(this.node,2,cc.Label).getComponent(cc.Label);\n        this.nameLabel.horizontalAlign = cc.Label.HorizontalAlign.CENTER;\n        this.nameLabel.verticalAlign = cc.Label.VerticalAlign.TOP;\n        this.nameLabel.node.color = new cc.Color(255,255,255);\n        this.nameLabel.node.anchorX = 0;\n        this.nameLabel.node.anchorY = 0;\n        this.nameLabel.node.x = 0;\n        this.nameLabel.node.y = 200;\n        this.nameLabel.node.height = 0;\n        this.nameLabel.fontSize = 100;\n        this.nameLabel.node.anchorX = 0.5;\n        this.nameLabel.node.anchorY = 0.5;\n\n        //this.node.rotation = 30;\n\n        o0CC.addSprite(this.node,'elements/ChainsawSheet');\n        this.rigidBody = this.node.addComponent(cc.RigidBody);\n        this.rigidBody.enabledContactListener = true;\n        this.rigidBody.gravityScale = 0;\n        this.rigidBody.fixedRotation = false;\n        //this.rigidBody.bullet = true;\n        //rigidBody.type = cc.RigidBodyType.Static;\n        this.collider = this.node.addComponent(cc.PhysicsBoxCollider);\n        this.collider.size = new cc.Size(190,59);\n        this.collider.density = 1;//0就不会旋转角度\n        this.collider.sensor = true;\n        this.collider.apply();\n\n        //this.joint.connectedBody = this.bodyRigidBody;\n        //this.joint.anchor = cc.v2(0,40);\n        //this.joint.apply();\n\n        \n    },\n\n    // called every frame\n    update: function (dt) {\n        var newLabelString = this.name;\n        /*\n        if(this.joint == null){//空中\n            newLabelString += '; air';\n        }else if(this.joint.connectedBody.node.tag == o0Game.Tag.Ground){//插在地上\n            newLabelString += '; ground';\n        }else if(this.joint.connectedBody.node.tag == o0Game.Tag.Player && this.joint.connectedBody.getComponent('MODCharacter').hand != null){//拿在手上\n            newLabelString += '; hand';\n        }/** */\n        for(var i in this.invinciblePlayer){\n            newLabelString += '; '+this.invinciblePlayer[i].name;\n        }\n        if(newLabelString != this.nameLabel.string){\n            this.nameLabel.string = newLabelString;\n        }\n    },\n\n    updateJoint(direction){\n        if(this.joint == null){\n            return;\n        }\n\n        if(direction > 0){\n            this.joint.connectedAnchor = cc.v2(45,0);\n            this.joint.referenceAngle = 40;\n            this.joint.apply();\n        }else if(direction < 0){\n            this.joint.connectedAnchor = cc.v2(-45,0);\n            this.joint.referenceAngle = 180 - 40;\n            this.joint.apply();\n        }\n    },\n    connectPlayer(MODCharacter){\n        if(this.joint!=null){\n            if(this.joint.connectedBody.node.tag == o0Game.Tag.player){\n                this.joint.connectedBody.getComponent('MODCharacter').hand = null;\n            }\n            this.joint.destroy();\n            this.joint = null;\n        }\n\n        this.invinciblePlayer = [];\n        this.invinciblePlayer.push(MODCharacter);\n\n        MODCharacter.hand = this;\n        this.joint = this.node.addComponent(cc.WeldJoint);\n        this.joint.connectedBody = MODCharacter.getComponent(cc.RigidBody);\n        this.joint.apply();\n        this.joint.enabled = true;\n        this.collider.sensor = false;\n        this.collider.apply();\n        this.updateJoint(MODCharacter.node.scaleX);\n    },\n    connectGround(MODMap){\n        if(this.joint!=null){\n            if(this.joint.connectedBody.node.tag == o0Game.Tag.player){\n                this.joint.connectedBody.getComponent('MODCharacter').hand = null;\n            }\n            this.joint.destroy();\n            this.joint = null;\n        }\n        this.joint = this.node.addComponent(cc.WeldJoint);\n        this.joint.connectedBody = MODMap.getComponent(cc.RigidBody);\n        this.joint.apply();\n        this.joint.enabled = true;\n        this.collider.sensor = true;\n        this.collider.apply();\n    },\n    disconnect(){\n        if(this.joint == null){\n            return;\n        }\n        if(this.joint.connectedBody.node.tag == o0Game.Tag.Player){\n            this.joint.connectedBody.getComponent('MODCharacter').hand = null;\n        }\n        this.joint.destroy();\n        this.joint = null;\n        this.collider.sensor = true;\n        this.collider.apply();\n    },\n    bounceOff(player,otherChainsaw,otherPlayer,contact){\n        if(this.joint == null || this.joint.connectedBody.getComponent('MODCharacter') == null){\n            return;\n        }\n        \n        var worldManifold = contact.getWorldManifold();\n        var point = worldManifold.points[0];\n        if(point == undefined){\n            cc.log(this.name+'???');\n        }/** */\n        this.invinciblePlayer = [];\n        if(otherPlayer != null){\n            this.invinciblePlayer.push(otherPlayer);\n        }\n        if(player != null){\n            this.invinciblePlayer.push(player);\n            player.hand = null;\n        }\n        this.joint.destroy();\n        this.joint = null;\n        this.collider.sensor = true;\n        this.collider.apply();\n\n\n        this.scheduleOnce(() => {\n            var force = cc.v2(this.node.x - otherChainsaw.node.x,30).normalizeSelf().mulSelf(2000);\n            this.rigidBody.linearVelocity = force;\n            this.rigidBody.angularVelocity = (Math.random()-0.5)*1000;\n        }, 0.01);\n        if(player!=null){\n            this.scheduleOnce(() => {\n                var force = cc.v2(this.node.x - otherChainsaw.node.x,30).normalizeSelf().mulSelf(500);\n                player.rigidBody.linearVelocity = force;\n            }, 0.01);\n        }\n\n        //var force = v2point.sub(otherPlayerBody.node.position).mulSelf(500);\n        //var force = cc.v2(this.node.x - otherChainsaw.node.x,50).normalizeSelf().mulSelf(5000);\n        //this.rigidBody.linearVelocity = force;\n\n        //this.rigidBody.angularVelocity+=this.joint.connectedAnchor.x;\n        //this.rigidBody.applyLinearImpulse(force,point,true);\n    },\n    \n    onBeginContact: function (contact, selfCollider, otherCollider) {\n        if(this.host == false){\n            return;\n        }\n        var self = this;\n\n        if(this.joint == null){//空中\n            if(otherCollider.node.tag == o0Game.Tag.Player){//撞到玩家\n                var player = otherCollider.getComponent('MODCharacter');\n                for(var i in this.invinciblePlayer){\n                    if(player == this.invinciblePlayer[i]){\n                        return;\n                    }\n                }\n                //cc.log(1)\n                if(otherCollider.getComponent('MODCharacter').hand!=null && otherCollider.getComponent('MODCharacter').hand.node.tag == o0Game.Tag.Chainsaw){\n                    otherCollider.getComponent('MODCharacter').hand.bounceOff(null,this,null,contact);\n                }\n                otherCollider.node.active = false;\n            }else if(otherCollider.node.tag == o0Game.Tag.Ground){//撞到地上\n                this.joint = this.node.addComponent(cc.WeldJoint);\n                this.joint.connectedBody = otherCollider.body;\n                //this.joint.connectedAnchor = this.node.position;\n                //this.joint.referenceAngle = this.node.rotation;\n                this.joint.connectedAnchor = this.node.position;\n                this.joint.referenceAngle = -this.node.rotation;\n                this.joint.apply();\n                this.invinciblePlayer = [];\n            }\n        }else if(this.joint.connectedBody.node.tag == o0Game.Tag.Ground){//插在地上\n            if(otherCollider.node.tag == o0Game.Tag.Player && otherCollider.node.getComponent('MODCharacter').hand == null){//撞到玩家，并且玩家空手\n                this.connectPlayer(otherCollider.node.getComponent('MODCharacter'));\n            }\n        }else if(this.joint.connectedBody.node.tag == o0Game.Tag.Player && this.joint.connectedBody.getComponent('MODCharacter').hand != null){//拿在手上\n            if(otherCollider.body.node.tag == o0Game.Tag.Player){//撞到玩家\n                var player = otherCollider.getComponent('MODCharacter');\n                for(var i in this.invinciblePlayer){\n                    if(player == this.invinciblePlayer[i]){\n                        return;\n                    }\n                }\n                //cc.log(2)\n                if(otherCollider.getComponent('MODCharacter').hand!=null && otherCollider.getComponent('MODCharacter').hand.node.tag == o0Game.Tag.Chainsaw){\n                    otherCollider.getComponent('MODCharacter').hand.bounceOff(null,this,this.joint.connectedBody.getComponent('MODCharacter'),contact);\n                }\n                otherCollider.node.active = false;\n            }else if(otherCollider.node.tag == o0Game.Tag.Chainsaw && otherCollider.getComponent('MODChainsaw').joint!=null && otherCollider.getComponent('MODChainsaw').joint.connectedBody.getComponent('MODCharacter')!=null){//撞到电锯，并且电锯被拿着                \n                cc.log(this.name);\n                var chainsawA = selfCollider.getComponent('MODChainsaw');\n                var playerA = chainsawA.joint.connectedBody.getComponent('MODCharacter');\n                var chainsawB = otherCollider.getComponent('MODChainsaw');\n                var playerB = chainsawB.joint.connectedBody.getComponent('MODCharacter');\n                chainsawA.bounceOff(playerA,chainsawB,playerB,contact);\n                chainsawB.bounceOff(playerB,chainsawA,playerA,contact);\n            }\n        }\n    },/** */\n});\n\n\n"]}